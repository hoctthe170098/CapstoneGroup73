<div class="container-fluid">
  <h2 class="mb-3">CH·ªàNH S·ª¨A L·ªöP H·ªåC</h2>

  <div class="card shadow-sm">
    <div class="card-body">
      <form [formGroup]="editLopForm" (ngSubmit)="onSubmit()">
        <!-- T√™n l·ªõp & ch∆∞∆°ng tr√¨nh -->
        <div class="row">
          <div class="col-md-6">
            <div class="form-group">
              <label for="tenLop">T√™n l·ªõp</label>
              <input id="tenLop" type="text" class="form-control" formControlName="tenLop"
                     [readonly]="!canEditAll" placeholder="Nh·∫≠p t√™n l·ªõp" />
                     <small class="text-danger" *ngIf="editLopForm.get('tenLop')?.touched && editLopForm.get('tenLop')?.hasError('required')">
                      T√™n l·ªõp kh√¥ng ƒë∆∞·ª£c ƒë·ªÉ tr·ªëng!
                    </small>
                    <small class="text-danger" *ngIf="editLopForm.get('tenLop')?.touched && editLopForm.get('tenLop')?.hasError('maxlength')">
                      T√™n l·ªõp kh√¥ng ƒë∆∞·ª£c qu√° 20 k√Ω t·ª±!
                    </small>
            </div>
           
          </div>

          <div class="col-md-6">
            <div class="form-group">
              <label for="chuongTrinh">Ch∆∞∆°ng tr√¨nh h·ªçc</label>
              <select id="chuongTrinh" class="form-control" formControlName="chuongTrinh" [disabled]="!canEditAll">
                <option [ngValue]="null" disabled>Ch·ªçn ch∆∞∆°ng tr√¨nh h·ªçc</option>
                <option *ngFor="let ct of chuongTrinhList" [ngValue]="ct">{{ ct.tieuDe }}</option>
              </select>
              <small class="text-danger" *ngIf="editLopForm.get('chuongTrinh')?.touched && editLopForm.get('chuongTrinh')?.hasError('required')">
                Vui l√≤ng ch·ªçn ch∆∞∆°ng tr√¨nh h·ªçc!
              </small>
            </div>
          </div>
        </div>

        <!-- H·ªçc ph√≠, gi√°o vi√™n, ng√†y b·∫Øt ƒë·∫ßu, ng√†y k·∫øt th√∫c -->
        <div class="row">
          <div class="col-md-3">
            <div class="form-group">
              <label for="hocPhi">H·ªçc ph√≠</label>
              <input id="hocPhi" type="number" class="form-control" formControlName="hocPhi"
                     [readonly]="!canEditAll" />
                     <small class="text-danger" *ngIf="editLopForm.get('hocPhi')?.touched && editLopForm.get('hocPhi')?.hasError('required')">
                      H·ªçc ph√≠ kh√¥ng ƒë∆∞·ª£c ƒë·ªÉ tr·ªëng!
                    </small>
                    <small class="text-danger" *ngIf="editLopForm.get('hocPhi')?.touched && editLopForm.get('hocPhi')?.hasError('min')">
                      H·ªçc ph√≠ ph·∫£i l·ªõn h∆°n ho·∫∑c b·∫±ng 50.000!
                    </small>       
            </div>
            
          </div>

          <div class="col-md-3">
            <div class="form-group">
              <label for="giaoVien">Gi√°o vi√™n</label>
              <select id="giaoVien" class="form-control" formControlName="giaoVien" [disabled]="!canEditAll">
                <option [ngValue]="null" disabled>Ch·ªçn gi√°o vi√™n</option>
                <option *ngFor="let gv of giaoVienList" [ngValue]="gv">{{ gv.codeTen }}</option>
              </select>
              <small class="text-danger" *ngIf="editLopForm.get('giaoVien')?.touched && editLopForm.get('giaoVien')?.hasError('required')">
                Vui l√≤ng ch·ªçn gi√°o vi√™n!
              </small>
            </div>
          </div>

          <div class="col-md-3">
            <div class="form-group">
              <label for="ngayBatDau">Ng√†y b·∫Øt ƒë·∫ßu</label>
              <input id="ngayBatDau" type="date" class="form-control" formControlName="ngayBatDau" [readonly]="!canEditAll" />
              <small class="text-danger" *ngIf="editLopForm.get('ngayBatDau')?.touched && editLopForm.get('ngayBatDau')?.hasError('invalidStartDate')">
                Ng√†y b·∫Øt ƒë·∫ßu ph·∫£i sau h√¥m nay!
              </small>
            </div>
          </div>

          <div class="col-md-3">
            <div class="form-group">
              <label for="ngayKetThuc">Ng√†y k·∫øt th√∫c</label>
              <input id="ngayKetThuc" type="date" class="form-control" formControlName="ngayKetThuc"
                     [readonly]="!canEditAll" />
                     <small class="text-danger" *ngIf="editLopForm.get('ngayKetThuc')?.touched && editLopForm.get('ngayKetThuc')?.hasError('required')">
                      Vui l√≤ng ch·ªçn ng√†y k·∫øt th√∫c!
                    </small>
                    <small class="text-danger" *ngIf="editLopForm.get('ngayKetThuc')?.hasError('invalidEndDate')">
                      Ng√†y k·∫øt th√∫c ph·∫£i sau √≠t nh·∫•t 2 th√°ng k·ªÉ t·ª´ ng√†y b·∫Øt ƒë·∫ßu!
                    </small>
            </div>
          </div>
        </div>

        <!-- L·ªãch h·ªçc trong tu·∫ßn -->
        <div class="mt-3">
          <label class="form-label fw-bold">L·ªãch H·ªçc Trong Tu·∫ßn</label>
        </div>

        <div formArrayName="lichHoc">
          <div class="form-group row align-items-center" *ngFor="let schedule of lichHoc.controls; let i = index" [formGroupName]="i">
            <div class="col-md-3 mb-2">
              <label>Th·ª© trong tu·∫ßn</label>
              <select class="form-control" formControlName="thu" [disabled]="!canEditAll">
                <option value="">Ch·ªçn th·ª© trong tu·∫ßn</option>
                <option value="2">Th·ª© hai</option>
                <option value="3">Th·ª© ba</option>
                <option value="4">Th·ª© t∆∞</option>
                <option value="5">Th·ª© nƒÉm</option>
                <option value="6">Th·ª© s√°u</option>
                <option value="7">Th·ª© b·∫£y</option>
                <option value="8">Ch·ªß nh·∫≠t</option>
              </select>
            </div>

            <div class="col-md-2 mb-2">
              <label>Gi·ªù b·∫Øt ƒë·∫ßu</label>
              <input type="time" class="form-control" formControlName="gioBatDau" [readonly]="!canEditAll" />
            </div>

            <div class="col-md-2 mb-2">
              <label>Gi·ªù k·∫øt th√∫c</label>
              <input type="time" class="form-control" formControlName="gioKetThuc" [readonly]="!canEditAll" />
            </div>

            <div class="col-md-3 mb-2">
              <label>Ph√≤ng</label>
              <select class="form-control" formControlName="phong">
                <option [ngValue]="null">Ch·ªçn ph√≤ng</option>
                <option *ngFor="let p of phongList" [ngValue]="p">{{ p.ten }}</option>
              </select>
            </div>

            <div class="col-md-2 mb-2 d-flex align-items-center justify-content-center" *ngIf="canEditAll">
              <button type="button" class="btn btn-danger" (click)="removeSchedule(i)">-</button>
            </div>
          </div>

          <button type="button" class="btn btn-primary mt-2" (click)="addSchedule()" *ngIf="canEditAll">+</button>
        </div>

        <!-- Danh s√°ch h·ªçc vi√™n -->
        <div class="mt-4">
          <label class="form-label fw-bold">Danh S√°ch H·ªçc Vi√™n</label>
          <table class="table table-bordered table-hover mt-2">
            <thead class="table-light">
              <tr>
                <th>Code</th>
                <th>T√™n</th>
                <th>Gi·ªõi t√≠nh</th>
                <th>Ng√†y sinh</th>
                <th>Email</th>
                <th>SƒêT</th>
                <th *ngIf="true">Action</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let hv of hocVienList; let i = index">
                <td>{{ hv.code }}</td>
                <td>{{ hv.ten }}</td>
                <td>{{ hv.gioiTinh }}</td>
                <td>{{ hv.ngaySinh | date: 'dd-MM-yyyy' }}</td>
                <td>{{ hv.email }}</td>
                <td>{{ hv.sdt }}</td>
                <td>
                  <button type="button" class="btn btn-sm btn-danger" (click)="removeHocVien(i)">üóëÔ∏è</button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Buttons -->
        <div class="d-flex justify-content-end mt-4">
          <button class="btn btn-secondary me-2" type="button" (click)="onCancel()">H·ªßy</button>
          <button class="btn btn-success" type="submit">X√°c nh·∫≠n</button>
        </div>
      </form>
    </div>
  </div>
</div>
