<div class="container-fluid">
  <h2 class="mb-3">CHỈNH SỬA LỚP HỌC</h2>

  <div class="card shadow-sm">
    <div class="card-body">
      <form [formGroup]="editLopForm" (ngSubmit)="onSubmit()">
        <div class="row">
          <!-- Tên lớp -->
          <div class="col-md-4">
            <div class="form-group">
              <label for="tenLop">Tên Lớp</label>
              <input id="tenLop" type="text" class="form-control" formControlName="tenLop" />
            </div>
            <small class="text-danger" *ngIf="editLopForm.get('tenLop').touched && editLopForm.get('tenLop').hasError('required')">
              Tên lớp không được để trống!
            </small>
            
          </div>

          <!-- Chương trình học -->
          <div class="col-md-4">
            <div class="form-group">
              <label for="chuongTrinh">Chương Trình Học</label>
              <select id="chuongTrinh" class="form-control" formControlName="chuongTrinh">
                <option *ngFor="let ct of chuongTrinhList" [ngValue]="ct">{{ ct.tenChuongTrinh }}</option>
              </select>
              <small class="text-danger" *ngIf="editLopForm.get('chuongTrinh').touched && editLopForm.get('chuongTrinh').hasError('required')">
                Vui lòng chọn chương trình học!
              </small>
            </div>
          </div>

          <!-- Trạng thái -->
          <div class="col-md-4">
            <div class="form-group">
              <label for="trangThai">Trạng Thái</label>
              <select id="trangThai" class="form-control" formControlName="trangThai">
                <option value="" selected>Chọn Trạng thái</option>
                <option value="active">Đang hoạt động</option>
                <option value="inactive">Ngừng hoạt động</option>
              </select>
            </div>
          </div>
        </div>

        <div class="row">
          <!-- Học phí -->
          <div class="col-md-4">
            <div class="form-group">
              <label for="hocPhi">Học Phí</label>
              <input id="hocPhi" type="text" class="form-control" formControlName="hocPhi" />
              <small class="text-danger" *ngIf="editLopForm.get('hocPhi').touched && editLopForm.get('hocPhi').hasError('required')">
                Học phí không được để trống!
              </small>
              <small class="text-danger" *ngIf="editLopForm.get('hocPhi').touched && editLopForm.get('hocPhi').hasError('min')">
                Học phí phải lớn hơn hoặc bằng 400.000!
              </small>
            </div>
          </div>

          <!-- Giáo viên -->
          <div class="col-md-4">
            <div class="form-group">
              <label for="giaoVien">Giáo Viên</label>
              <select id="giaoVien" class="form-control" formControlName="giaoVien">
                <option *ngFor="let gv of giaoVienList" [ngValue]="gv">{{ gv.tenGiaoVien }}</option>
              </select>
              <small class="text-danger" *ngIf="editLopForm.get('giaoVien').touched && editLopForm.get('giaoVien').hasError('required')">
                Vui lòng chọn giáo viên!
              </small>
            </div>
          </div>

          <!-- Ngày bắt đầu -->
          <div class="col-md-2">
            <div class="form-group">
              <label for="ngayBatDau">Ngày Bắt Đầu</label>
              <input id="ngayBatDau" type="date" class="form-control" formControlName="ngayBatDau" />
              <small class="text-danger" *ngIf="editLopForm.get('ngayBatDau').touched && editLopForm.get('ngayBatDau').hasError('required')">
                Vui lòng chọn ngày bắt đầu!
              </small>
              <small class="text-danger" *ngIf="editLopForm.get('ngayBatDau').touched && editLopForm.get('ngayBatDau').hasError('invalidStartDate')">
                Ngày bắt đầu phải từ hôm nay trở đi!
              </small>
            </div>
           
          </div>

          <!-- Ngày kết thúc -->
          <div class="col-md-2">
            <div class="form-group">
              <label for="ngayKetThuc">Ngày Kết Thúc</label>
              <input id="ngayKetThuc" type="date" class="form-control" formControlName="ngayKetThuc" />
              <small class="text-danger" *ngIf="editLopForm.get('ngayKetThuc').touched && editLopForm.get('ngayKetThuc').hasError('required')">
                Vui lòng chọn ngày kết thúc!
              </small>
              <small class="text-danger" *ngIf="editLopForm.get('ngayKetThuc').touched && editLopForm.get('ngayKetThuc').hasError('invalidEndDate')">
                Ngày kết thúc phải sau ít nhất 2 tháng kể từ ngày bắt đầu!
              </small>
            </div>
          </div>
        </div>

        <!-- Lịch học trong tuần -->
        <div class="mt-3">
          <label class="form-label fw-bold">Lịch Học Trong Tuần</label>
        </div>

        <div formArrayName="lichHoc">
          <div class="form-group row align-items-center" *ngFor="let schedule of lichHoc.controls; let i = index" [formGroupName]="i">
            <div class="col-md-3 mb-2">
              <label for="Chonthutrongtuan">Thứ trong tuần</label>
              <select class="form-control" formControlName="thu">
                
                <option value="" selected>Chọn thứ trong tuần</option>
                <option value="2">Thứ hai</option>
                <option value="3">Thứ ba</option>
                <option value="4">Thứ tư</option>
                <option value="5">Thứ năm</option>
                <option value="6">Thứ sáu</option>
                <option value="7">Thứ bảy</option>
                <option value="8">Chủ nhật</option>
              </select>
              <small class="text-danger" *ngIf="schedule.get('thu').touched && schedule.get('thu').hasError('required')">
                  Vui lòng chọn thứ trong tuần!
                </small>
            </div>

            <div class="col-md-2 mb-2">
              <label for="gioBatDau">Giờ bắt đầu</label>
              <input type="time" class="form-control" formControlName="gioBatDau" placeholder="Giờ bắt đầu" />
              <small class="text-danger" *ngIf="schedule.get('gioBatDau').touched && schedule.get('gioBatDau').hasError('required')">
                  Vui lòng chọn giờ bắt đầu!
                </small>
            </div>

            <div class="col-md-2 mb-2">
              <label for="gioKetThuc">Giờ kết thúc</label>
              <input type="time" class="form-control" formControlName="gioKetThuc" placeholder="Giờ kết thúc" />
              <small class="text-danger" *ngIf="schedule.get('gioKetThuc').touched && schedule.get('gioKetThuc').hasError('required')">
                  Vui lòng chọn giờ kết thúc!
                </small>
            </div>
            <!-- Phòng -->
          <div class="col-md-2 mb-2">
            
              <label for="phong">Phòng</label>
              <select id="phong" class="form-control" formControlName="phong">
                <option [ngValue]="null">Chọn phòng</option>
                <option *ngFor="let p of phongList" [ngValue]="p">
                  {{ p.tenPhong }}
                </option>>
              </select>
              <small class="text-danger" *ngIf="schedule.get('phong').touched && schedule.get('phong').hasError('required')">
                Vui lòng chọn phòng học!
              </small>
              
            
          </div>
            

            
        </div>

          
        </div>

        <!-- Nút Hủy & Xác Nhận -->
        <div class="d-flex justify-content-end mt-4">
          <button class="btn btn-danger ms-2" (click)="onCancel()">Hủy</button>
          <button class="btn btn-success" type="submit">Xác Nhận</button>
        </div>
      </form>
    </div>
  </div>
</div>
